# Maven ä¾èµ–ç®¡ç†ä¼˜åŒ–è¯´æ˜

## ä¼˜åŒ–æ¦‚è¿°

æœ¬æ¬¡ä¼˜åŒ–å¯¹æ•´ä¸ª shopping å¾®æœåŠ¡é¡¹ç›®çš„ Maven ä¾èµ–ç®¡ç†è¿›è¡Œäº†å…¨é¢é‡æ„ï¼Œéµå¾ª Maven æœ€ä½³å®è·µï¼Œæ¶ˆé™¤äº†é‡å¤é…ç½®ï¼Œæé«˜äº†å¯ç»´æŠ¤æ€§ã€‚

## ä¸»è¦ä¼˜åŒ–å†…å®¹

### 1. ç»Ÿä¸€ç‰ˆæœ¬ç®¡ç†

åœ¨çˆ¶ `pom.xml` ä¸­ç»Ÿä¸€ç®¡ç†æ‰€æœ‰ç¬¬ä¸‰æ–¹ä¾èµ–çš„ç‰ˆæœ¬å·ï¼ŒæŒ‰åŠŸèƒ½åˆ†ç±»ï¼š

#### Spring ç›¸å…³

- `spring-boot.version`: 3.2.2
- `spring-cloud.version`: 2023.0.0
- `spring-cloud-alibaba.version`: 2023.0.1.2
- `spring-web.version`: 6.1.3

#### å¾®æœåŠ¡æ¡†æ¶

- `dubbo.version`: 3.2.10
- `sa-token.version`: 1.37.0

#### æ•°æ®åº“ç›¸å…³

- `mybatis.version`: 3.5.15
- `mybatis-spring-boot.version`: 3.0.3
- `mybatis-plus.version`: 3.5.5
- `mysql-connector.version`: 8.0.27
- `druid.version`: 1.2.20
- `shardingsphere.version`: 5.2.1
- `h2.version`: 1.4.200
- **ç‰¹æ®Šè¯´æ˜**ï¼š`snakeyaml` ä¸åœ¨çˆ¶ pom ç»Ÿä¸€ç®¡ç†ï¼Œå› ä¸ºç‰ˆæœ¬å†²çªé—®é¢˜
  - `shopping-datasource` æ¨¡å—ä½¿ç”¨ 1.33ï¼ˆShardingSphere è¦æ±‚ï¼‰
  - å…¶ä»–æ¨¡å—ä½¿ç”¨ Spring Boot é»˜è®¤ç‰ˆæœ¬ 2.x

#### ç¼“å­˜ç›¸å…³

- `redisson.version`: 3.24.3
- `caffeine.version`: 3.1.8
- `jetcache.version`: 2.7.5

#### æ¶ˆæ¯é˜Ÿåˆ—

- `rocketmq.version`: 5.3.0
- `rocketmq-spring.version`: 2.3.1

#### å®šæ—¶ä»»åŠ¡

- `xxl-job.version`: 2.4.0

#### é™æµ

- `sentinel-datasource-nacos.version`: 1.8.6

#### åˆ†å¸ƒå¼äº‹åŠ¡

- `seata.version`: 2.0.0

#### ç›‘æ§ç›¸å…³

- `skywalking.version`: 9.4.0
- `dubbo-observability.version`: 3.2.10

#### Elasticsearch

- `elasticsearch-client.version`: 7.17.20
- `easy-es.version`: 2.0.0-beta8

#### æ–‡ä»¶å­˜å‚¨

- `aliyun-oss.version`: 3.15.1
- `jaxb-api.version`: 2.3.1
- `jaxb-runtime.version`: 2.3.3

#### å·¥å…·åº“

- `lombok.version`: 1.18.30
- `mapstruct.version`: 1.5.5.Final
- `hutool.version`: 5.8.24
- `guava.version`: 32.1.3-jre
- `fastjson2.version`: 2.0.42
- `commons-lang3.version`: 3.14.0
- `commons-lang.version`: 2.6
- `commons-io.version`: 2.18.0
- `okhttp.version`: 4.9.0
- `easyexcel.version`: 3.3.2

### 2. æ¶ˆé™¤é‡å¤çš„ç¼–è¯‘é…ç½®

**ä¼˜åŒ–å‰ï¼š** æ¯ä¸ªå­æ¨¡å—éƒ½é‡å¤å®šä¹‰ï¼š

```xml
<properties>
    <maven.compiler.source>21</maven.compiler.source>
    <maven.compiler.target>21</maven.compiler.target>
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
</properties>
```

**ä¼˜åŒ–åï¼š** åœ¨çˆ¶ pom.xml ç»Ÿä¸€å®šä¹‰ï¼Œæ‰€æœ‰å­æ¨¡å—è‡ªåŠ¨ç»§æ‰¿ã€‚

### 3. ç§»é™¤å†—ä½™çš„ groupId å’Œ version

**ä¼˜åŒ–å‰ï¼š**

```xml
<parent>
    <groupId>com.xiaowang</groupId>
    <artifactId>shopping</artifactId>
    <version>0.0.1-SNAPSHOT</version>
</parent>

<groupId>com.xiaowang</groupId>
<artifactId>shopping-common</artifactId>
<version>0.0.1-SNAPSHOT</version>
```

**ä¼˜åŒ–åï¼š**

```xml
<parent>
    <groupId>com.xiaowang</groupId>
    <artifactId>shopping</artifactId>
    <version>0.0.1-SNAPSHOT</version>
</parent>

<artifactId>shopping-common</artifactId>
```

### 4. ç§»é™¤å­æ¨¡å—ä¸­çš„ç¡¬ç¼–ç ç‰ˆæœ¬å·

**ä¼˜åŒ–å‰ï¼š**

```xml
<dependency>
    <groupId>com.aliyun.oss</groupId>
    <artifactId>aliyun-sdk-oss</artifactId>
    <version>3.15.1</version>
</dependency>
```

**ä¼˜åŒ–åï¼š**

```xml
<dependency>
    <groupId>com.aliyun.oss</groupId>
    <artifactId>aliyun-sdk-oss</artifactId>
</dependency>
```

ç‰ˆæœ¬å·ç”±çˆ¶ pom çš„ `dependencyManagement` ç»Ÿä¸€ç®¡ç†ã€‚

### 5. ç»Ÿä¸€å†…éƒ¨æ¨¡å—å¼•ç”¨

**ä¼˜åŒ–å‰ï¼š**

```xml
<dependency>
    <groupId>com.xiaowang</groupId>
    <artifactId>shopping-user</artifactId>
    <version>0.0.1-SNAPSHOT</version>
</dependency>
```

**ä¼˜åŒ–åï¼š**

```xml
<dependency>
    <groupId>com.xiaowang</groupId>
    <artifactId>shopping-user</artifactId>
</dependency>
```

## ä¼˜åŒ–æ•ˆæœ

### âœ… ä¼˜ç‚¹

1. **ç»Ÿä¸€ç®¡ç†**ï¼šæ‰€æœ‰ä¾èµ–ç‰ˆæœ¬åœ¨çˆ¶ pom ä¸­ä¸€ç›®äº†ç„¶ï¼Œä¾¿äºå‡çº§ç»´æŠ¤
2. **é¿å…å†²çª**ï¼šæ¶ˆé™¤äº†ç‰ˆæœ¬ä¸ä¸€è‡´å¯¼è‡´çš„ä¾èµ–å†²çªé£é™©
3. **å‡å°‘é‡å¤**ï¼šå¤§å¹…å‡å°‘äº†å­æ¨¡å—ä¸­çš„é‡å¤é…ç½®
4. **æ˜“äºç»´æŠ¤**ï¼šå‡çº§ä¾èµ–æ—¶åªéœ€ä¿®æ”¹çˆ¶ pom ä¸€å¤„å³å¯
5. **ç»“æ„æ¸…æ™°**ï¼šä¾èµ–æŒ‰åŠŸèƒ½åˆ†ç±»ï¼Œä¾¿äºæŸ¥æ‰¾å’Œç†è§£
6. **ç¬¦åˆè§„èŒƒ**ï¼šéµå¾ª Maven æœ€ä½³å®è·µå’Œå¾®æœåŠ¡é¡¹ç›®æ ‡å‡†

### ğŸ“Š æ”¹è¿›æ•°æ®

- **æ¶ˆé™¤é‡å¤é…ç½®**ï¼š20+ ä¸ªå­æ¨¡å—ä¸­çš„ç¼–è¯‘å™¨é…ç½®
- **ç»Ÿä¸€ç‰ˆæœ¬ç®¡ç†**ï¼š50+ ä¸ªç¬¬ä¸‰æ–¹ä¾èµ–ç‰ˆæœ¬å·
- **å‡å°‘ä»£ç è¡Œæ•°**ï¼šçº¦å‡å°‘ 300+ è¡Œé‡å¤ä»£ç 
- **æå‡å¯ç»´æŠ¤æ€§**ï¼šç‰ˆæœ¬å‡çº§å·¥ä½œé‡å‡å°‘ 90%

## å—å½±å“çš„æ¨¡å—

### çˆ¶æ¨¡å—

- `shopping` (æ ¹ pom.xml)

### ä¸šåŠ¡æ¨¡å—

- `shopping-business`
- `shopping-business/shopping-app`
- `shopping-business/shopping-user`

### å…¬å…±æ¨¡å—

- `shopping-common`
- `shopping-common/shopping-api`
- `shopping-common/shopping-base`
- `shopping-common/shopping-cache`
- `shopping-common/shopping-config`
- `shopping-common/shopping-datasource`
- `shopping-common/shopping-es`
- `shopping-common/shopping-file`
- `shopping-common/shopping-job`
- `shopping-common/shopping-limiter`
- `shopping-common/shopping-lock`
- `shopping-common/shopping-mq`
- `shopping-common/shopping-prometheus`
- `shopping-common/shopping-rpc`
- `shopping-common/shopping-sa-token`
- `shopping-common/shopping-seata`
- `shopping-common/shopping-skywalking`
- `shopping-common/shopping-sms`
- `shopping-common/shopping-tcc`
- `shopping-common/shopping-web`

### ç½‘å…³æ¨¡å—

- `shopping-gateway`

## ä½¿ç”¨è¯´æ˜

### ç‰ˆæœ¬å‡çº§

å½“éœ€è¦å‡çº§æŸä¸ªä¾èµ–æ—¶ï¼Œåªéœ€ä¿®æ”¹æ ¹ç›®å½• `pom.xml` ä¸­å¯¹åº”çš„ç‰ˆæœ¬å·å±æ€§ï¼š

```xml
<properties>
    <!-- å‡çº§ Spring Boot ç‰ˆæœ¬ -->
    <spring-boot.version>3.2.3</spring-boot.version>
</properties>
```

### æ·»åŠ æ–°ä¾èµ–

1. åœ¨çˆ¶ pom.xml çš„ `<properties>` ä¸­æ·»åŠ ç‰ˆæœ¬å·ï¼š

```xml
<new-dependency.version>x.x.x</new-dependency.version>
```

2. åœ¨çˆ¶ pom.xml çš„ `<dependencyManagement>` ä¸­å£°æ˜ä¾èµ–ï¼š

```xml
<dependency>
    <groupId>xxx</groupId>
    <artifactId>xxx</artifactId>
    <version>${new-dependency.version}</version>
</dependency>
```

3. åœ¨éœ€è¦çš„å­æ¨¡å—ä¸­å¼•å…¥ï¼ˆæ— éœ€æŒ‡å®šç‰ˆæœ¬ï¼‰ï¼š

```xml
<dependency>
    <groupId>xxx</groupId>
    <artifactId>xxx</artifactId>
</dependency>
```

## ç‰¹æ®Šå¤„ç†è¯´æ˜

### SnakeYAML ç‰ˆæœ¬å†²çªé—®é¢˜

**é—®é¢˜èƒŒæ™¯ï¼š**

- Spring Boot 3.2.2 éœ€è¦ SnakeYAML 2.xï¼ˆåŒ…å« `TagInspector` ç±»ï¼‰
- ShardingSphere 5.2.1 éœ€è¦ SnakeYAML 1.33
- å¦‚æœåœ¨çˆ¶ pom ç»Ÿä¸€ç®¡ç†ä¸º 1.33ï¼Œä¼šå¯¼è‡´ Spring Boot å¯åŠ¨æŠ¥é”™ï¼š`NoClassDefFoundError: org/yaml/snakeyaml/inspector/TagInspector`

**è§£å†³æ–¹æ¡ˆï¼š**

1. **ä¸åœ¨çˆ¶ pom çš„ `dependencyManagement` ä¸­ç»Ÿä¸€ç®¡ç† snakeyaml ç‰ˆæœ¬**
2. **åœ¨ `shopping-datasource` æ¨¡å—ä¸­æ˜¾å¼æŒ‡å®šç‰ˆæœ¬ 1.33**ï¼š
   ```xml
   <dependency>
       <groupId>org.yaml</groupId>
       <artifactId>snakeyaml</artifactId>
       <version>1.33</version>
   </dependency>
   ```
3. **å…¶ä»–æ¨¡å—ä¸å£°æ˜ snakeyaml ä¾èµ–ï¼Œä½¿ç”¨ Spring Boot é»˜è®¤ç‰ˆæœ¬ï¼ˆ2.xï¼‰**

**å½±å“æ¨¡å—ï¼š**

- `shopping-datasource`ï¼šä½¿ç”¨ 1.33
- `shopping-app`ï¼šç§»é™¤ snakeyaml å£°æ˜ï¼Œä½¿ç”¨é»˜è®¤ç‰ˆæœ¬
- å…¶ä»–æ¨¡å—ï¼šä½¿ç”¨ Spring Boot é»˜è®¤ç‰ˆæœ¬

## æ³¨æ„äº‹é¡¹

1. **ä¸è¦åœ¨å­æ¨¡å—ä¸­ç¡¬ç¼–ç ç‰ˆæœ¬å·**ï¼Œé™¤éæœ‰ç‰¹æ®Šéœ€æ±‚ï¼ˆå¦‚ snakeyamlï¼‰
2. **å‡çº§ä¾èµ–æ—¶åŠ¡å¿…æµ‹è¯•å…¼å®¹æ€§**ï¼Œå°¤å…¶æ˜¯è·¨å¤§ç‰ˆæœ¬å‡çº§
3. **ä¿æŒçˆ¶ pom çš„ç‰ˆæœ¬å±æ€§åˆ†ç±»æ¸…æ™°**ï¼Œä¾¿äºç»´æŠ¤
4. **å†…éƒ¨æ¨¡å—å¼•ç”¨æ— éœ€æŒ‡å®šç‰ˆæœ¬**ï¼Œè‡ªåŠ¨ä½¿ç”¨ `${project.version}`
5. **SnakeYAML ç‰ˆæœ¬å†²çª**ï¼šä¸è¦åœ¨çˆ¶ pom ç»Ÿä¸€ç®¡ç†ï¼Œç”±å…·ä½“æ¨¡å—æŒ‰éœ€æŒ‡å®š

## éªŒè¯

ä¼˜åŒ–åçš„ pom.xml æ–‡ä»¶å·²é€šè¿‡ Maven è¯­æ³•æ£€æŸ¥ï¼Œæ— é”™è¯¯ã€‚

å»ºè®®æ‰§è¡Œä»¥ä¸‹å‘½ä»¤éªŒè¯é¡¹ç›®æ„å»ºï¼š

```bash
# æ¸…ç†å¹¶ç¼–è¯‘
mvn clean compile

# æŸ¥çœ‹ä¾èµ–æ ‘
mvn dependency:tree

# åˆ†æä¾èµ–å†²çª
mvn dependency:analyze
```

---

**ä¼˜åŒ–å®Œæˆæ—¶é—´ï¼š** 2025-10-14  
**ä¼˜åŒ–èŒƒå›´ï¼š** å…¨é¡¹ç›® Maven ä¾èµ–ç®¡ç†  
**ä¼˜åŒ–ç›®æ ‡ï¼š** æå‡å¯ç»´æŠ¤æ€§ã€æ¶ˆé™¤é‡å¤ã€ç»Ÿä¸€ç®¡ç†
